#!/usr/bin/make -f

dh_targets=binary binary-arch binary-indep build build-arch build-indep clean install

$(dh_targets) %:
	dh $@ --with autoreconf --parallel

.PHONY: $(dh_targets)

override_dh_auto_build:
	egrep -q '^flags[[:space:]]*:.*\bsse2\b' /proc/cpuinfo \
	 || (echo "error: CPU instruction set extension sse2 not found."; \
	     echo "   aborting build process"; \
	     exit 1)
	dh_auto_build -- -C src
	dh_auto_build -- -C scheme

override_dh_install:
	dh_install
	rm debian/ikarus/usr/share/doc/ikarus/COPYING
	rm debian/ikarus/usr/share/doc/ikarus/GPL-3

override_dh_compress:
	dh_compress -Xikarus-scheme-users-guide.pdf
