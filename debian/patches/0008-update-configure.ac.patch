From: "Barak A. Pearlmutter" <barak+git@pearlmutter.net>
Date: Sun, 17 May 2020 17:07:17 +0100
Subject: update configure.ac

---
 configure.ac | 40 ++++++++++++++++++++--------------------
 1 file changed, 20 insertions(+), 20 deletions(-)

diff --git a/configure.ac b/configure.ac
index 35d75e8..4f83efa 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1,9 +1,9 @@
 #                                               -*- Autoconf -*-
 # Process this file with autoconf to produce a configure script.
 
-AC_PREREQ(2.59)
-AC_INIT(ikarus, 0.0.4-rc1, aghuloum@cs.indiana.edu)
-AC_CANONICAL_SYSTEM
+AC_PREREQ([2.69])
+AC_INIT([ikarus],[0.0.4-rc1],[aghuloum@cs.indiana.edu])
+AC_CANONICAL_TARGET
 AM_INIT_AUTOMAKE(ikarus, 0.0.4-rc1, gnu)
 AC_CONFIG_SRCDIR([src/])
 
@@ -27,7 +27,7 @@ case "$target_os" in
     LDFLAGS="-Wl,-E -Wl,--export-all-symbols $LDFLAGS"
     ;;
   *darwin*)
-    AC_DEFINE(HACK_FFI, 1, 
+    AC_DEFINE(HACK_FFI, 1,
               [Mark code returned by libffi executable because
                libffi does not do that yet.  This so far is only
                important on Snow Leopard in 64-bit mode but we
@@ -37,7 +37,7 @@ case "$target_os" in
 
 AC_CHECK_SIZEOF(void *)
 if test "$ac_cv_sizeof_void_p" = 4; then
-   AC_DEFINE(FLAT_TABLES, 1, 
+   AC_DEFINE(FLAT_TABLES, 1,
      [use flat segment and dirty vectors (not used yet)])
 fi
 
@@ -64,19 +64,20 @@ AC_CHECK_HEADERS([assert.h dlfcn.h errno.h fcntl.h signal.h \
 AC_CHECK_LIB(pthread, main)
 
 AC_CHECK_HEADERS([gmp.h],,[AC_MSG_ERROR([
-ERROR: Cannot find libgmp. 
+ERROR: Cannot find libgmp.
 ERROR: You might want to supply CFLAGS=-I</path/to/include> (containing
 ERROR: the gmp.h header file), and LDFLAGS=-L</path/to/lib> (containing
 ERROR: libgmp.so) if libgmp is installed in a non-standard location.
 ERROR: libgmp can be obtained from <http://gmplib.org>. ])])
 
 # check that gmp is present
-AC_HAVE_LIBRARY([gmp],,[AC_MSG_ERROR([
-ERROR: Cannot find libgmp. 
+AC_CHECK_LIB([gmp],[main],[],[AC_MSG_ERROR([
+ERROR: Cannot find libgmp.
 ERROR: You might want to supply CFLAGS=-I</path/to/include> (containing
 ERROR: the gmp.h header file), and LDFLAGS=-L</path/to/lib> (containing
 ERROR: libgmp.so) if libgmp is installed in a non-standard location.
-ERROR: libgmp can be obtained from <http://gmplib.org>. ])])
+ERROR: libgmp can be obtained from <http://gmplib.org>. ])],[])
+
 
 AC_ARG_ENABLE(libffi,
   AS_HELP_STRING([--enable-libffi], [enable support for libffi (default is check)]),
@@ -112,27 +113,27 @@ fi # "$enable_ffi" != no
 AC_DEFINE_UNQUOTED(ENABLE_LIBFFI, [$libffi_val], [adds support for libffi])
 
 AC_CHECK_MEMBER([struct stat.st_mtimespec],
-   AC_DEFINE(HAVE_STAT_ST_MTIMESPEC, 1, 
+   AC_DEFINE(HAVE_STAT_ST_MTIMESPEC, 1,
              [stat struct has st_mtimespec field]),
-   [], 
+   [],
    [[#include <sys/stat.h>]])
 
 AC_CHECK_MEMBER([struct stat.st_mtim],
-   AC_DEFINE(HAVE_STAT_ST_MTIM, 1, 
+   AC_DEFINE(HAVE_STAT_ST_MTIM, 1,
              [stat struct has st_mtim field]),
-   [], 
+   [],
    [[#include <sys/stat.h>]])
 
 AC_CHECK_MEMBER([struct stat.st_ctimespec],
-   AC_DEFINE(HAVE_STAT_ST_CTIMESPEC, 1, 
+   AC_DEFINE(HAVE_STAT_ST_CTIMESPEC, 1,
              [stat struct has st_ctimespec field]),
-   [], 
+   [],
    [[#include <sys/stat.h>]])
 
 AC_CHECK_MEMBER([struct stat.st_ctim],
-   AC_DEFINE(HAVE_STAT_ST_CTIM, 1, 
+   AC_DEFINE(HAVE_STAT_ST_CTIM, 1,
              [stat struct has st_ctim field]),
-   [], 
+   [],
    [[#include <sys/stat.h>]])
 
 
@@ -156,6 +157,5 @@ AC_FUNC_STRFTIME
 AC_FUNC_STRTOD
 AC_CHECK_FUNCS([sigaltstack bzero gettimeofday memmove memset munmap setenv sqrt strerror getaddrinfo])
 AC_CONFIG_HEADERS([config.h])
-AC_CONFIG_FILES(Makefile src/Makefile scheme/Makefile doc/Makefile lib/Makefile benchmarks/Makefile)
-AC_OUTPUT #(Makefile src/Makefile scheme/Makefile doc/Makefile)
-
+AC_CONFIG_FILES([Makefile src/Makefile scheme/Makefile doc/Makefile lib/Makefile benchmarks/Makefile])
+AC_OUTPUT
